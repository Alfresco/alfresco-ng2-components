language: node_js
dist: trusty
sudo: required
node_js:
  - "6"

before_install:
  - sudo apt-get update
  - sudo apt-get install chromium-chromedriver
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"

env:
  matrix:
    - MODULE=ng2-components
    - MODULE=ng2-demo-shell

script:
  - if ([ "$MODULE" == "ng2-components" ]); then
        (./scripts/npm-build-all.sh -t;);
    fi
  - if ([ "$MODULE" == "ng2-demo-shell" ]); then
        (./scripts/npm-build-all.sh && cd demo-shell-ng2 && npm install && npm run build && npm run test  && npm run protractor-test || exit 1;);
    fi

# Send coverage data to Coveralls
after_success:
  bash <(curl -s https://codecov.io/bash) -X gcov

cache:
  directories:
  - ./node_modules/material-design-lite
  - ./node_modules/material-design-icons
  - demo-shell-ng2/node_modules
  - ng2-components/node_modules
